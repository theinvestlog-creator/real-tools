---
import Base from "../../../src/layouts/Base.astro";
import fs from 'node:fs';
import path from 'node:path';

const root = process.cwd();
const indexPath = path.join(root, 'public', 'data', 'indicators', 'index.json');

let items = [];
try {
  const raw = fs.readFileSync(indexPath, 'utf-8');
  const json = JSON.parse(raw);
  items = Array.isArray(json.items) ? json.items : [];
} catch {
  items = [];
}
---
<Base title="Indicators">
  <div class="content-header"><div class="container-fluid">
    <h1 class="m-0">Indicators</h1>
    <p class="text-muted">Server-rendered hub (no client fetch).</p>
  </div></div>

  <ul class="list-group">
    {items.length === 0
      ? <li class="list-group-item text-muted">No indicators available. Ensure public/data/indicators/index.json exists.</li>
      : items.map((slug) => (
          <li class="list-group-item">
            <a href={`/indicators/${slug}/`}>{slug}</a>
          </li>
        ))
    }
  </ul>
</Base>
